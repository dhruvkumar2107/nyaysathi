(()=>{var e={};e.id=4750,e.ids=[4750],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},13455:()=>{},91623:()=>{},3683:()=>{},64041:()=>{},12285:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>h,tree:()=>d});var r=s(7),i=s(8533),a=s(29377),n=s.n(a),l=s(29799),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d=["",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,31608)),"C:\\Users\\DHRUV\\Downloads\\project\\client\\src\\app\\messages\\page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,58412)),"C:\\Users\\DHRUV\\Downloads\\project\\client\\src\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,73472,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\DHRUV\\Downloads\\project\\client\\src\\app\\messages\\page.js"],x="/messages/page",u={require:s,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/messages/page",pathname:"/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},76508:(e,t,s)=>{Promise.resolve().then(s.bind(s,37152))},37152:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(54714),i=s(77580),a=s(36546),n=s(11968),l=s(66239),o=s(57801),d=s(43015),c=s(79224),x=s(3682),u=s(59858);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let h=(0,u.Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);var p=s(15420);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,u.Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),g=(0,u.Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),b=(0,u.Z)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),f=(0,u.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),w=(0,l.io)(process.env.NEXT_PUBLIC_API_URL?.replace("/api","")||"http://localhost:4000");function j(){let{user:e}=(0,n.useAuth)(),t=(0,o.useSearchParams)().get("chatId"),[s,l]=(0,i.useState)([]),[u,j]=(0,i.useState)(null),[y,v]=(0,i.useState)([]),[N,_]=(0,i.useState)(""),k=(0,i.useRef)(null),[q,D]=(0,i.useState)(!0);(0,i.useEffect)(()=>{if(e)C();else{let e=setTimeout(()=>D(!1),3e3);return()=>clearTimeout(e)}},[e]);let C=async()=>{try{let s=e._id||e.id;if(!s){D(!1);return}let r=await a.Z.get(`/api/connections?userId=${s}`),i=Array.isArray(r.data)?r.data:[];if(l(i),t){let e=i.find(e=>e._id===t);e?j(e):i.length>0&&j(i[0])}else i.length>0&&j(i[0])}catch(e){console.error("Failed to fetch connections",e)}finally{D(!1)}};(0,i.useEffect)(()=>{if(!u||!e)return;(async()=>{try{let t=u._id,s=await a.Z.get(`/api/messages/${t}`);v(s.data);let r=[e._id||e.id,t].sort().join("-");w.emit("join_room",r)}catch(e){console.error("Failed to fetch messages",e)}})();let t=t=>{let s=e._id||e.id,r=u._id;(t.sender._id===r||t.sender===r||t.sender._id===s||t.sender===s)&&v(e=>e.some(e=>e._id===t._id)?e:[...e,t])};return w.on("receive_message",t),()=>{w.off("receive_message",t)}},[u,e]),(0,i.useEffect)(()=>{k.current?.scrollIntoView({behavior:"smooth"})},[y]);let S=async()=>{if(!N.trim()||!u)return;let t=u._id,s={_id:Date.now().toString(),sender:{_id:e._id||e.id,name:e.name},content:N,createdAt:new Date().toISOString()};v(e=>[...e,s]),_("");try{await a.Z.post("/api/messages/send",{recipientId:t,content:N})}catch(e){console.error("Send failed",e)}};return q?r.jsx("div",{className:"h-screen flex items-center justify-center bg-[#020617] text-white",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),r.jsx("p",{className:"mt-4 text-indigo-300 font-bold uppercase tracking-widest text-xs",children:"Establishing Secure Uplink..."})]})}):(0,r.jsxs)("div",{className:"h-screen bg-[#020617] overflow-hidden flex flex-col font-sans text-slate-400 selection:bg-indigo-500/30",children:[r.jsx(d.default,{}),(0,r.jsxs)("div",{className:"flex-1 flex max-w-[1800px] mx-auto w-full pt-20 px-4 pb-4 gap-6 h-[calc(100vh)]",children:[(0,r.jsxs)("aside",{className:"w-96 bg-white/5 backdrop-blur-xl rounded-[2rem] border border-white/10 flex flex-col overflow-hidden hidden md:flex shadow-2xl",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-white/5 to-transparent",children:[r.jsx("h2",{className:"text-xl font-bold text-white mb-4 font-serif",children:"Encrypted Chats"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(x.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500",size:16}),r.jsx("input",{placeholder:"Search conversations...",className:"w-full bg-black/40 border border-white/10 rounded-xl pl-10 pr-4 py-3 text-sm text-white outline-none focus:border-indigo-500 transition placeholder:text-slate-600"})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-2",children:[0===s.length&&(0,r.jsxs)("div",{className:"text-center p-8 opacity-30 mt-10",children:[r.jsx("span",{className:"text-4xl block mb-4 grayscale",children:"\uD83D\uDCED"}),r.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-slate-500",children:"No Active Links"})]}),s.map(e=>(0,r.jsxs)(c.E.div,{whileTap:{scale:.98},onClick:()=>j(e),className:`p-4 rounded-2xl cursor-pointer transition-all flex items-center gap-4 relative group ${u?._id===e._id?"bg-indigo-600/20 border border-indigo-500/50 shadow-lg shadow-indigo-600/10":"hover:bg-white/5 border border-transparent hover:border-white/5"}`,children:[r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg shadow-inner ${u?._id===e._id?"bg-indigo-500 text-white":"bg-white/10 text-slate-400"}`,children:e.name?e.name[0]:"?"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:`font-bold truncate text-sm ${u?._id===e._id?"text-white":"text-slate-300"}`,children:e.name}),r.jsx("p",{className:`text-xs truncate font-medium ${u?._id===e._id?"text-indigo-300":"text-slate-500"}`,children:"lawyer"===e.role?`âš–ï¸ ${e.specialization}`:`ðŸ“ ${e.location}`})]}),u?._id===e._id&&r.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(129,140,248,0.8)]"})]},e._id))]})]}),r.jsx("section",{className:"flex-1 bg-[#020617]/50 backdrop-blur-xl rounded-[2rem] border border-white/10 flex flex-col overflow-hidden relative shadow-2xl",children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"p-5 border-b border-white/5 flex justify-between items-center bg-white/5 backdrop-blur-md z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white flex items-center justify-center font-bold shadow-lg shadow-indigo-500/20 text-xl",children:u.name?u.name[0]:"?"}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-bold text-white text-lg font-serif",children:u.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),r.jsx("span",{className:"text-xs text-emerald-400 font-bold uppercase tracking-wider",children:"Secure Connection Active"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{className:"p-3 rounded-xl bg-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition border border-white/5",children:r.jsx(h,{size:20})}),r.jsx("button",{onClick:()=>{let e=`nyay-${Date.now()}`,t=`${window.location.origin}/meet/${e}`;window.open(t,"_blank"),_(`ðŸ“ž Join Secure Video Link: ${t}`),setTimeout(()=>S(),100)},className:"p-3 rounded-xl bg-indigo-600 text-white hover:bg-indigo-500 transition shadow-lg shadow-indigo-600/20 border border-indigo-500",title:"Start Video Call",children:r.jsx(p.Z,{size:20})}),r.jsx("button",{className:"p-3 rounded-xl bg-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition border border-white/5",children:r.jsx(m,{size:20})})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-8 space-y-6 custom-scrollbar bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-opacity-5",children:[0===y.length&&(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center opacity-30",children:[r.jsx("div",{className:"w-24 h-24 bg-white/10 rounded-full flex items-center justify-center text-5xl mb-6 grayscale",children:"\uD83D\uDCAC"}),r.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest",children:"Encrypted Channel Ready"})]}),y.map((t,s)=>{let i=(t.sender?._id||t.sender)===(e._id||e.id);return r.jsx(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${i?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:`max-w-[70%] px-6 py-4 rounded-3xl text-sm leading-relaxed shadow-lg backdrop-blur-md border ${i?"bg-indigo-600 text-white border-indigo-500 rounded-tr-md":"bg-white/5 text-slate-200 border-white/10 rounded-tl-md"}`,children:[t.content.includes("http")&&t.content.includes("meet/")?(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("span",{className:"font-bold flex items-center gap-2 text-indigo-200",children:[r.jsx(p.Z,{size:14})," Video Meeting Invite"]}),r.jsx("a",{href:t.content.split(": ")[1],target:"_blank",rel:"noreferrer",className:"underline font-bold text-white hover:text-indigo-200 break-all",children:"Join Now"})]}):t.content,r.jsx("div",{className:`text-[10px] mt-2 opacity-60 text-right font-bold tracking-wider ${i?"text-indigo-200":"text-slate-500"}`,children:t.createdAt&&new Date(t.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},s)}),r.jsx("div",{ref:k})]}),r.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 backdrop-blur-lg",children:(0,r.jsxs)("div",{className:"relative flex items-center gap-3 bg-white/5 p-2 pr-3 rounded-2xl border border-white/10 focus-within:border-indigo-500/50 focus-within:bg-black/40 transition-all shadow-inner",children:[r.jsx("button",{className:"p-3 text-slate-400 hover:text-white transition rounded-xl hover:bg-white/5",children:r.jsx(g,{size:20})}),r.jsx("input",{value:N,onChange:e=>_(e.target.value),onKeyDown:e=>"Enter"===e.key&&S(),placeholder:"Type an encrypted message...",className:"flex-1 bg-transparent border-none outline-none text-white placeholder-slate-500 font-medium h-10 px-2"}),r.jsx("button",{className:"p-3 text-slate-400 hover:text-yellow-400 transition rounded-xl hover:bg-white/5",children:r.jsx(b,{size:20})}),r.jsx("button",{onClick:S,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-3 rounded-xl shadow-lg shadow-indigo-600/20 transition-all transform active:scale-95 border border-indigo-400/20",children:r.jsx(f,{size:20})})]})})]}):(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-500 bg-black/20",children:[r.jsx("div",{className:"w-40 h-40 bg-white/5 rounded-full flex items-center justify-center shadow-[0_0_50px_rgba(255,255,255,0.05)] mb-8 animate-pulse-slow",children:r.jsx("span",{className:"text-7xl drop-shadow-2xl",children:"\uD83D\uDCE1"})}),r.jsx("h3",{className:"text-2xl font-bold text-white mb-2 font-serif",children:"Secure Command Center"}),r.jsx("p",{className:"max-w-xs text-center text-sm",children:"Select a secure frequency from the left to establish communication."})]})})]})]})}},31608:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>a,__esModule:()=>i,default:()=>n});let r=(0,s(71481).createProxy)(String.raw`C:\Users\DHRUV\Downloads\project\client\src\app\messages\page.js`),{__esModule:i,$$typeof:a}=r,n=r.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[3499,2900,9040,6239,1928],()=>s(12285));module.exports=r})();