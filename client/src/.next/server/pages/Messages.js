"use strict";(()=>{var e={};e.id=6410,e.ids=[6410,660],e.modules={59183:(e,t,s)=>{s.d(t,{Z:()=>i});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(34740).Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},95232:(e,t,s)=>{s.d(t,{Z:()=>i});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(34740).Z)("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]])},20381:(e,t,s)=>{s.d(t,{Z:()=>i});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(34740).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},54285:(e,t,s)=>{s.d(t,{Z:()=>i});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(34740).Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]])},3559:(e,t,s)=>{s.d(t,{Z:()=>i});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,s(34740).Z)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]])},58841:(e,t,s)=>{s.a(e,async(e,i)=>{try{s.r(t),s.d(t,{config:()=>b,default:()=>m,getServerSideProps:()=>g,getStaticPaths:()=>p,getStaticProps:()=>u,reportWebVitals:()=>f,routeModule:()=>_,unstable_getServerProps:()=>y,unstable_getServerSideProps:()=>N,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>w});var r=s(39847),a=s(2603),l=s(38847),n=s(16532),o=s.n(n),d=s(94273),c=s.n(d),x=s(36107),h=e([x]);x=(h.then?(await h)():h)[0];let m=(0,l.l)(x,"default"),u=(0,l.l)(x,"getStaticProps"),p=(0,l.l)(x,"getStaticPaths"),g=(0,l.l)(x,"getServerSideProps"),b=(0,l.l)(x,"config"),f=(0,l.l)(x,"reportWebVitals"),w=(0,l.l)(x,"unstable_getStaticProps"),j=(0,l.l)(x,"unstable_getStaticPaths"),v=(0,l.l)(x,"unstable_getStaticParams"),y=(0,l.l)(x,"unstable_getServerProps"),N=(0,l.l)(x,"unstable_getServerSideProps"),_=new r.PagesRouteModule({definition:{kind:a.x.PAGES,page:"/Messages",pathname:"/Messages",bundlePath:"",filename:""},components:{App:c(),Document:o()},userland:x});i()}catch(e){i(e)}})},36107:(e,t,s)=>{s.a(e,async(e,i)=>{try{s.r(t),s.d(t,{default:()=>j});var r=s(20997),a=s(16689),l=s(99648),n=s(89800),o=s(14612),d=s(63662),c=s(95382),x=s(66197),h=s(81630),m=s(20381),u=s(65711),p=s(59183),g=s(95232),b=s(3559),f=s(54285),w=e([l,n,o,c,x]);[l,n,o,c,x]=w.then?(await w)():w;let v=(0,o.io)(process.env.NEXT_PUBLIC_API_URL?.replace("/api","")||"http://localhost:4000");function j(){let{user:e}=(0,n.a)(),[t]=(0,d.useSearchParams)(),s=t.get("chatId"),[i,o]=(0,a.useState)([]),[w,j]=(0,a.useState)(null),[y,N]=(0,a.useState)([]),[_,S]=(0,a.useState)(""),k=(0,a.useRef)(null),[P,Z]=(0,a.useState)(!0);(0,a.useEffect)(()=>{if(e)C();else{let e=setTimeout(()=>Z(!1),3e3);return()=>clearTimeout(e)}},[e]);let C=async()=>{try{let t=e._id||e.id;if(!t){Z(!1);return}let i=await l.default.get(`/api/connections?userId=${t}`),r=Array.isArray(i.data)?i.data:[];if(o(r),s){let e=r.find(e=>e._id===s);e?j(e):r.length>0&&j(r[0])}else r.length>0&&j(r[0])}catch(e){console.error("Failed to fetch connections",e)}finally{Z(!1)}};(0,a.useEffect)(()=>{if(!w||!e)return;(async()=>{try{let t=w._id,s=await l.default.get(`/api/messages/${t}`);N(s.data);let i=[e._id||e.id,t].sort().join("-");v.emit("join_room",i)}catch(e){console.error("Failed to fetch messages",e)}})();let t=t=>{let s=e._id||e.id,i=w._id;(t.sender._id===i||t.sender===i||t.sender._id===s||t.sender===s)&&N(e=>e.some(e=>e._id===t._id)?e:[...e,t])};return v.on("receive_message",t),()=>{v.off("receive_message",t)}},[w,e]),(0,a.useEffect)(()=>{k.current?.scrollIntoView({behavior:"smooth"})},[y]);let D=async()=>{if(!_.trim()||!w)return;let t=w._id,s={_id:Date.now().toString(),sender:{_id:e._id||e.id,name:e.name},content:_,createdAt:new Date().toISOString()};N(e=>[...e,s]),S("");try{await l.default.post("/api/messages/send",{recipientId:t,content:_})}catch(e){console.error("Send failed",e)}};return P?r.jsx("div",{className:"h-screen flex items-center justify-center bg-[#020617] text-white",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),r.jsx("p",{className:"mt-4 text-indigo-300 font-bold uppercase tracking-widest text-xs",children:"Establishing Secure Uplink..."})]})}):(0,r.jsxs)("div",{className:"h-screen bg-[#020617] overflow-hidden flex flex-col font-sans text-slate-400 selection:bg-indigo-500/30",children:[r.jsx(c.Z,{}),(0,r.jsxs)("div",{className:"flex-1 flex max-w-[1800px] mx-auto w-full pt-20 px-4 pb-4 gap-6 h-[calc(100vh)]",children:[(0,r.jsxs)("aside",{className:"w-96 bg-white/5 backdrop-blur-xl rounded-[2rem] border border-white/10 flex flex-col overflow-hidden hidden md:flex shadow-2xl",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-white/5 bg-gradient-to-r from-white/5 to-transparent",children:[r.jsx("h2",{className:"text-xl font-bold text-white mb-4 font-serif",children:"Encrypted Chats"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(h.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-500",size:16}),r.jsx("input",{placeholder:"Search conversations...",className:"w-full bg-black/40 border border-white/10 rounded-xl pl-10 pr-4 py-3 text-sm text-white outline-none focus:border-indigo-500 transition placeholder:text-slate-600"})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3 space-y-2",children:[0===i.length&&(0,r.jsxs)("div",{className:"text-center p-8 opacity-30 mt-10",children:[r.jsx("span",{className:"text-4xl block mb-4 grayscale",children:"\uD83D\uDCED"}),r.jsx("p",{className:"text-sm font-bold uppercase tracking-widest text-slate-500",children:"No Active Links"})]}),i.map(e=>(0,r.jsxs)(x.motion.div,{whileTap:{scale:.98},onClick:()=>j(e),className:`p-4 rounded-2xl cursor-pointer transition-all flex items-center gap-4 relative group ${w?._id===e._id?"bg-indigo-600/20 border border-indigo-500/50 shadow-lg shadow-indigo-600/10":"hover:bg-white/5 border border-transparent hover:border-white/5"}`,children:[r.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center font-bold text-lg shadow-inner ${w?._id===e._id?"bg-indigo-500 text-white":"bg-white/10 text-slate-400"}`,children:e.name?e.name[0]:"?"}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:`font-bold truncate text-sm ${w?._id===e._id?"text-white":"text-slate-300"}`,children:e.name}),r.jsx("p",{className:`text-xs truncate font-medium ${w?._id===e._id?"text-indigo-300":"text-slate-500"}`,children:"lawyer"===e.role?`âš–ï¸ ${e.specialization}`:`ðŸ“ ${e.location}`})]}),w?._id===e._id&&r.jsx("div",{className:"w-2 h-2 bg-indigo-400 rounded-full animate-pulse shadow-[0_0_10px_rgba(129,140,248,0.8)]"})]},e._id))]})]}),r.jsx("section",{className:"flex-1 bg-[#020617]/50 backdrop-blur-xl rounded-[2rem] border border-white/10 flex flex-col overflow-hidden relative shadow-2xl",children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"p-5 border-b border-white/5 flex justify-between items-center bg-white/5 backdrop-blur-md z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 text-white flex items-center justify-center font-bold shadow-lg shadow-indigo-500/20 text-xl",children:w.name?w.name[0]:"?"}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-bold text-white text-lg font-serif",children:w.name}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"relative flex h-2 w-2",children:[r.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),r.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),r.jsx("span",{className:"text-xs text-emerald-400 font-bold uppercase tracking-wider",children:"Secure Connection Active"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("button",{className:"p-3 rounded-xl bg-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition border border-white/5",children:r.jsx(m.Z,{size:20})}),r.jsx("button",{onClick:()=>{let e=`nyay-${Date.now()}`,t=`${window.location.origin}/meet/${e}`;window.open(t,"_blank"),S(`ðŸ“ž Join Secure Video Link: ${t}`),setTimeout(()=>D(),100)},className:"p-3 rounded-xl bg-indigo-600 text-white hover:bg-indigo-500 transition shadow-lg shadow-indigo-600/20 border border-indigo-500",title:"Start Video Call",children:r.jsx(u.Z,{size:20})}),r.jsx("button",{className:"p-3 rounded-xl bg-white/5 text-slate-400 hover:text-white hover:bg-white/10 transition border border-white/5",children:r.jsx(p.Z,{size:20})})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-8 space-y-6 custom-scrollbar bg-[url('https://grainy-gradients.vercel.app/noise.svg')] bg-opacity-5",children:[0===y.length&&(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center opacity-30",children:[r.jsx("div",{className:"w-24 h-24 bg-white/10 rounded-full flex items-center justify-center text-5xl mb-6 grayscale",children:"\uD83D\uDCAC"}),r.jsx("p",{className:"text-slate-400 font-bold uppercase tracking-widest",children:"Encrypted Channel Ready"})]}),y.map((t,s)=>{let i=(t.sender?._id||t.sender)===(e._id||e.id);return r.jsx(x.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`flex ${i?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:`max-w-[70%] px-6 py-4 rounded-3xl text-sm leading-relaxed shadow-lg backdrop-blur-md border ${i?"bg-indigo-600 text-white border-indigo-500 rounded-tr-md":"bg-white/5 text-slate-200 border-white/10 rounded-tl-md"}`,children:[t.content.includes("http")&&t.content.includes("meet/")?(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("span",{className:"font-bold flex items-center gap-2 text-indigo-200",children:[r.jsx(u.Z,{size:14})," Video Meeting Invite"]}),r.jsx("a",{href:t.content.split(": ")[1],target:"_blank",rel:"noreferrer",className:"underline font-bold text-white hover:text-indigo-200 break-all",children:"Join Now"})]}):t.content,r.jsx("div",{className:`text-[10px] mt-2 opacity-60 text-right font-bold tracking-wider ${i?"text-indigo-200":"text-slate-500"}`,children:t.createdAt&&new Date(t.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},s)}),r.jsx("div",{ref:k})]}),r.jsx("div",{className:"p-6 border-t border-white/5 bg-black/20 backdrop-blur-lg",children:(0,r.jsxs)("div",{className:"relative flex items-center gap-3 bg-white/5 p-2 pr-3 rounded-2xl border border-white/10 focus-within:border-indigo-500/50 focus-within:bg-black/40 transition-all shadow-inner",children:[r.jsx("button",{className:"p-3 text-slate-400 hover:text-white transition rounded-xl hover:bg-white/5",children:r.jsx(g.Z,{size:20})}),r.jsx("input",{value:_,onChange:e=>S(e.target.value),onKeyDown:e=>"Enter"===e.key&&D(),placeholder:"Type an encrypted message...",className:"flex-1 bg-transparent border-none outline-none text-white placeholder-slate-500 font-medium h-10 px-2"}),r.jsx("button",{className:"p-3 text-slate-400 hover:text-yellow-400 transition rounded-xl hover:bg-white/5",children:r.jsx(b.Z,{size:20})}),r.jsx("button",{onClick:D,className:"bg-indigo-600 hover:bg-indigo-500 text-white p-3 rounded-xl shadow-lg shadow-indigo-600/20 transition-all transform active:scale-95 border border-indigo-400/20",children:r.jsx(f.Z,{size:20})})]})})]}):(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-slate-500 bg-black/20",children:[r.jsx("div",{className:"w-40 h-40 bg-white/5 rounded-full flex items-center justify-center shadow-[0_0_50px_rgba(255,255,255,0.05)] mb-8 animate-pulse-slow",children:r.jsx("span",{className:"text-7xl drop-shadow-2xl",children:"\uD83D\uDCE1"})}),r.jsx("h3",{className:"text-2xl font-bold text-white mb-2 font-serif",children:"Secure Command Center"}),r.jsx("p",{className:"max-w-xs text-center text-sm",children:"Select a secure frequency from the left to establish communication."})]})})]})]})}i()}catch(e){i(e)}})},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},62785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},16689:e=>{e.exports=require("react")},20997:e=>{e.exports=require("react/jsx-runtime")},99648:e=>{e.exports=import("axios")},66197:e=>{e.exports=import("framer-motion")},14612:e=>{e.exports=import("socket.io-client")},71017:e=>{e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[6532,8937,5382],()=>s(58841));module.exports=i})();